<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Jeu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: monospace;
    cursor: none;
}

body {
    background: white;
    color: black;
    height: 100vh;
    overflow: hidden;
}

/* ÉCRAN TEXTE */
.center {
    position: fixed;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 32px;
}

/* JEU */
#score {
    position: fixed;
    top: 20px;
    right: 20px;
    font-size: 24px;
    display: none;
    z-index: 10;
}

#target {
    position: absolute;
    width: 100px;
    height: 100px;
    display: none;
}

#target img {
    width: 100%;
    height: 100%;
}

#crosshair {
    position: fixed;
    width: 5px;
    height: 5px;
    background: white;
    transform: translate(-50%, -50%);
    pointer-events: none;
    display: none;
    z-index: 1000;
    border-radius: 50%;
}

/* VIDÉO */
video {
    position: fixed;
    inset: 0;
    width: 100%;
    height: 100%;
}

/* CARTE */
#card-container {
    position: fixed;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    perspective: 1000px;
    cursor: pointer;
}

#card {
    width: 300px;
    height: 300px;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.8s;
}


    #card:hover {
        transform: scale(1.1);
    }

#card.flip {
    transform: rotateY(180deg);
}

@keyframes cardAppear {
    from {
        opacity: 0;
        transform: scale(0.6);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

.card-appear {
    animation: cardAppear 1s ease-out forwards;
    animation-delay: 0.1s;
}



.face {
    position: absolute;
    inset: 0;
    backface-visibility: hidden;
    display: grid;
    align-content: center;
    justify-content: center;
}

#back {
    background: #ff4654;
    width: 616px;
    height: 353px;
    color: black;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    transform: rotateY(180deg) translateX(25%);
    cursor: pointer;
}
</style>
</head>

<body>

<div id="screen" class="center">Mets en fullscreen stp brozer</div>

<div id="score">0 / 10</div>
<div id="crosshair"></div>

<div id="target">
    <img src="celestin.png">
</div>

<audio id="gunshot" src="gunshot.wav"></audio>

<script>
/* ===== ÉTAT GLOBAL ===== */
let score = 0;
let misses = 0;
let warned = false;
let awaitingWord = false;
let gameEnded = false;
let inputBuffer = "";
let moveInterval = 1500;
let intervalId;

/* ===== ÉLÉMENTS ===== */
const screen = document.getElementById("screen");
const target = document.getElementById("target");
const scoreDisplay = document.getElementById("score");
const crosshair = document.getElementById("crosshair");
const gunshot = document.getElementById("gunshot");

/* ===== FULLSCREEN ===== */
document.addEventListener("keydown", e => {
    if (e.key === "F11") {
        document.body.style.background = "black";
        document.body.style.color = "white";
        screen.textContent = "allez c'est parti";
        setTimeout(countdown, 1000);
    }
});

/* ===== DÉCOMPTE ===== */
function countdown() {
    let c = 3;
    screen.textContent = c;

    const t = setInterval(() => {
        c--;
        if (c === 0) {
            clearInterval(t);
            screen.style.display = "none";
            startGame();
        } else {
            screen.textContent = c;
        }
    }, 1000);
}


/* ===== JEU ===== */
function startGame() {
    scoreDisplay.style.display = "block";
    crosshair.style.display = "block";
    target.style.display = "block";
    moveTarget();
    startMoving();
}

function moveTarget() {
    const maxX = window.innerWidth - 100;
    const maxY = window.innerHeight - 100;
    target.style.left = Math.random() * maxX + "px";
    target.style.top = Math.random() * maxY + "px";
}

function startMoving() {
    clearInterval(intervalId);
    intervalId = setInterval(moveTarget, moveInterval);
}

/* ===== TIR ===== */
function shootHandler() {
    if (gameEnded || awaitingWord) return;

    gunshot.currentTime = 0;
    gunshot.play();
    misses++;
    checkMisses();
}

document.addEventListener("click", shootHandler);

target.addEventListener("click", e => {
    e.stopPropagation();
    if (gameEnded || awaitingWord) return;

    gunshot.currentTime = 0;
    gunshot.play();

    score++;
    misses = 0;
    scoreDisplay.textContent = score + " / 10";

    moveInterval = Math.max(300, moveInterval - 100);
    startMoving();
    moveTarget();
});

/* ===== RATÉS ===== */
function checkMisses() {
    if (gameEnded) return;

    if (misses > 4 && !warned) {
        alert("Bah alors on est nul ?");
        warned = true;
    }

    if (misses >= 10 && !awaitingWord) {
        awaitingWord = true;
        alert("Tape un mot au pif sur le clavier et fais entrée");
        document.addEventListener("keydown", wordInput);
    }
}

/* ===== MOT ===== */
function wordInput(e) {
    if (!awaitingWord) return;

    if (e.key === "Enter") {
        if (inputBuffer.toLowerCase() === "bite") {
            awaitingWord = false;
            gameEnded = true;
            inputBuffer = "";
            launchVideo();
        } else {
            inputBuffer = "";
        }
    } else if (e.key.length === 1) {
        inputBuffer += e.key;
    }
}

/* ===== VIDÉO ===== */
function launchVideo() {
    clearInterval(intervalId);

    target.style.display = "none";
    scoreDisplay.style.display = "none";
    crosshair.style.display = "none";

    const video = document.createElement("video");
    video.src = "Vidéo_sans_titre_‐_Réalisée_avec_Clipchamp_(7).mp4";
    video.autoplay = true;
    video.controls = false;
    video.playsInline = true;

    document.body.appendChild(video);

    video.addEventListener("ended", () => {
        video.remove();
        document.body.style.background = "black";
        setTimeout(showCard, 2000);
    });
}

/* ===== CARTE ===== */
function showCard() {
    document.body.style.cursor = "pointer";

    const container = document.createElement("div");
    container.id = "card-container";

    const card = document.createElement("div");
    card.id = "card";

    const front = document.createElement("div");
    front.className = "face";
    front.id = "front";
    front.innerHTML = `<img src="val.jpg">`;

    const back = document.createElement("div");
    back.className = "face";
    back.id = "back";
    back.textContent = "RA-E4ZG3NTTC2W6UFC7";

    card.append(front, back);
    container.appendChild(card);
    document.body.appendChild(container);

    container.onclick = () => card.classList.add("flip");

    back.onclick = e => {
        e.stopPropagation();
        navigator.clipboard.writeText("Tu feras gaffe t'as le zob à l'air");
        alert("Bon anniversaire");
        [
            "vieux frère",
            "je t'aime",
            "on en a vu des choses toi et moi",
            "pendaison ?",
            "pendaison",
            "allez va activer ton code",
            "enculé de merde",
            "à tout"
        ].forEach(msg => alert(msg));
    };
}

/* ===== CROSSHAIR ===== */
document.addEventListener("mousemove", e => {
    crosshair.style.left = e.clientX + "px";
    crosshair.style.top = e.clientY + "px";
});
</script>

</body>
</html>
